# Celebrity Dog Breeding Game - Implementation Plan

## Overview

This document provides a high-level roadmap for implementing the celebrity dog breeding game. It synthesizes the design document, CLAUDE.md, and GitHub issues into an actionable plan.

## Project Status

**Current State:** Pre-implementation (design phase complete)
**Target MVP:** 6 weeks
**Current Phase:** Foundation setup

## Architecture Summary

### Core Innovation
The game solves Phaser's SVG limitation by using **layered sprite composition** with RenderTexture. Dogs are procedurally generated by:
1. Loading separate PNG sprites (bodies, heads, features)
2. Compositing them with color tints at runtime
3. Caching the results for performance

### Key Systems
1. **GeneticSystem** - 50% inheritance, 40% blending, 10% mutation
2. **RaritySystem** - Five-tier rarity with synergy bonuses
3. **EconomySystem** - Balanced progression (5 min/common, 20 min/rare)
4. **NameGenerator** - Three-method pun generation (portmanteau, trait-based, Markov)
5. **SaveSystem** - Dual storage (LocalStorage + IndexedDB backup)
6. **LineageManager** - Efficient family tree tracking with O(1) lookups

## Implementation Phases

### Phase 1: Foundation (Week 1)
**Goal:** Get Phaser running with basic structure

**Critical Path:**
1. Project setup (Issue #1)
2. Utility helpers (Issue #2)
3. Placeholder assets (Issue #3)
4. Boot/Preload/Menu scenes (Issue #11, #12)

**Deliverable:** Phaser game boots, menu navigates to placeholder game scene

**Success Criteria:**
- [ ] `npm run dev` starts development server
- [ ] Phaser canvas renders at 1280x720
- [ ] Menu scene displays with functional buttons
- [ ] Can navigate to empty GameScene

---

### Phase 2: Core Systems (Week 2)
**Goal:** Implement breeding mechanics without UI

**Critical Path:**
1. CelebrityDog entity (Issue #4)
2. GeneticSystem breeding (Issue #5)
3. RaritySystem (Issue #6)
4. Unit tests (Issue #7)
5. ProceduralDogGenerator (Issue #8)
6. DogSprite component (Issue #9)

**Deliverable:** Can programmatically breed two dogs and render offspring

**Success Criteria:**
- [ ] Create two parent dogs in code
- [ ] Call `GeneticSystem.breed()` to create offspring
- [ ] Offspring has valid, inherited genes
- [ ] ProceduralDogGenerator creates visual texture
- [ ] DogSprite renders on screen with correct colors
- [ ] Unit tests pass (90%+ coverage)

**Validation Test:**
```javascript
const parent1 = new CelebrityDog({bodyType: 'athletic', coatColor: '#FF0000', ...});
const parent2 = new CelebrityDog({bodyType: 'fluffy', coatColor: '#0000FF', ...});
const offspring = GeneticSystem.breed(parent1.genes, parent2.genes);
// Offspring should have genes from parents or blended
```

---

### Phase 3: Game Loop (Week 3)
**Goal:** Playable breeding experience with economy

**Critical Path:**
1. GameScene (Issue #13)
2. UIScene overlay (Issue #14)
3. EconomySystem (Issue #15)
4. BreedingSystem orchestrator (Issue #16)
5. BreedingScene UI (Issue #17)

**Deliverable:** Can select two dogs, pay gold, breed them, see offspring

**Success Criteria:**
- [ ] GameScene displays owned dogs in grid
- [ ] UIScene shows current gold amount
- [ ] Click "Breed" button to open BreedingScene
- [ ] Select two parent dogs
- [ ] See breeding cost and preview
- [ ] Click "Confirm" to breed (deducts gold)
- [ ] See celebration animation and new offspring
- [ ] Offspring appears in kennel

**Validation Test:**
- Start with 500 gold and 3 starter dogs
- Breed two dogs (cost ~100-200 gold)
- Verify gold deducted correctly
- Verify offspring in kennel
- Try breeding with insufficient funds (should fail gracefully)

---

### Phase 4: Economy & Collection (Week 4)
**Goal:** Complete game loop with buy/sell

**Critical Path:**
1. ShopScene (Issue #18)
2. CollectionScene (Issue #19)
3. LineageManager (Issue #20)
4. Texture caching (Issue #10)

**Deliverable:** Full economic cycle (buy → breed → sell)

**Success Criteria:**
- [ ] ShopScene displays 10 starter dogs for purchase
- [ ] Can buy dog with gold
- [ ] CollectionScene shows all owned dogs
- [ ] Can filter/sort collection
- [ ] Can sell dogs for 50% value
- [ ] LineageManager tracks parent relationships
- [ ] Texture caching prevents redundant generation

**Validation Test:**
- Start new game with starting gold
- Buy 2 starter dogs from shop
- Breed them to create offspring
- Sell offspring for gold
- Use gold to buy another dog or breed again
- Verify complete economic loop

---

### Phase 5: Persistence & Polish (Week 5)
**Goal:** Save system and content creation

**Critical Path:**
1. NameGenerator (Issue #22)
2. SaveSystem (Issue #23)
3. Starter dogs content (Issue #24)
4. rexUI integration (Issue #25)

**Deliverable:** Game saves/loads, dogs have funny names

**Success Criteria:**
- [ ] All 10 starter celebrity dogs implemented
- [ ] Offspring receive generated names (puns)
- [ ] Can save game manually
- [ ] Auto-save every 60 seconds
- [ ] Game loads save on startup
- [ ] All game state preserved (dogs, gold, lineage)
- [ ] rexUI components used throughout

**Validation Test:**
- Play for 10 minutes, breed several dogs
- Close browser tab (triggers save)
- Reopen game
- Verify all dogs, gold, and progress preserved
- Verify dog names are funny and appropriate

---

### Phase 6: Final Polish (Week 6)
**Goal:** MVP ready for release

**Critical Path:**
1. Animations (Issue #26)
2. Tutorial system (Issue #27)
3. Performance optimization (Issue #28)
4. Integration tests (Issue #29)
5. Playtesting & balance (Issue #30)

**Deliverable:** Polished, tested, balanced MVP

**Success Criteria:**
- [ ] All key actions have satisfying animations
- [ ] First-time users see tutorial
- [ ] 60 FPS with 50+ dogs on screen
- [ ] Integration tests pass
- [ ] 5+ playtesters give positive feedback
- [ ] Economy balanced (5 min to common, 20-30 min to rare)
- [ ] No critical bugs

**Validation Test:**
- Give game to someone who's never played
- Observe them play for 30 minutes
- Verify they understand mechanics without help
- Track time to first breed, first rare dog
- Gather qualitative feedback

---

## Post-MVP Features (Week 7+)

### Priority 1 (v1.1)
- PedigreeScene family tree visualization (Issue #21)
- Dog shows/mini-games for earning gold
- Leaderboards (most valuable dog, highest generation)
- Social sharing (export dog images)

### Priority 2 (v1.2)
- Achievement system
- Unlockable traits
- Kennel upgrades/decorations
- More starter celebrity dogs

### Priority 3 (v1.3)
- Breeding projects/challenges
- Special events (limited-time traits)
- Trading system (multiplayer?)
- Advanced family tree features

---

## Risk Mitigation

### High-Risk Areas

**1. Procedural Generation Performance**
- **Risk:** Generating 50+ dog textures causes lag
- **Mitigation:**
  - Implement aggressive caching (Issue #10)
  - Prewarm cache with common combinations
  - Use object pooling for sprites
  - Profile early and optimize

**2. Economic Balance**
- **Risk:** Game too grindy or too easy
- **Mitigation:**
  - Implement metrics tracking (time to goals)
  - Conduct thorough playtesting (Issue #30)
  - Make costs easily tunable (constants file)
  - Plan for post-launch balance patches

**3. Name Generation Quality**
- **Risk:** Generated names aren't funny
- **Mitigation:**
  - Build large pun database (50+ names)
  - Weight toward reliable methods (portmanteau)
  - Allow manual naming option
  - Playtest name quality specifically

**4. Save System Reliability**
- **Risk:** Save corruption loses player progress
- **Mitigation:**
  - Dual storage (LocalStorage + IndexedDB)
  - Validation before loading
  - Versioning for migration
  - Extensive save/load testing

**5. Browser Compatibility**
- **Risk:** Game doesn't work on all browsers
- **Mitigation:**
  - Test on Chrome, Firefox, Safari, Edge
  - Use Phaser.AUTO (WebGL with Canvas fallback)
  - Polyfill IndexedDB if needed
  - Document minimum browser requirements

---

## Technical Decisions

### Build Tool: Vite (Recommended)
**Why:** Faster than Webpack, simpler config, great DX
**Alternative:** Webpack (if team more familiar)

### Testing: Vitest + Playwright
**Why:** Vitest integrates with Vite, Playwright for E2E
**Alternative:** Jest + Cypress

### No TypeScript for MVP
**Why:** Design doc uses JavaScript, faster iteration
**Consider:** TypeScript for post-MVP (better scalability)

### No Physics Engine
**Why:** Game doesn't need physics
**Benefit:** Lighter bundle, better performance

### rexUI for Complex UI
**Why:** Provides scrollable panels, grids, modals
**Fallback:** Build custom if rexUI adds too much complexity

---

## Development Guidelines

### Code Quality Standards
1. All business logic in `systems/`, not scenes
2. Unit tests for all systems (90%+ coverage)
3. JSDoc comments on public methods
4. No magic numbers (use named constants)
5. Error handling on all user actions
6. Console logging only in development

### Git Workflow
1. Feature branches: `feature/issue-XX-description`
2. PR required for merge to main
3. Squash commits on merge
4. Conventional commits (feat:, fix:, docs:, etc.)
5. Run tests + linter before push

### Performance Budgets
- Initial load: <3 seconds
- Frame rate: 60 FPS (16.67ms per frame)
- Memory: <100MB with 200+ dogs
- Bundle size: <2MB (uncompressed)

---

## Getting Started

### Prerequisites
- Node.js 18+
- npm or yarn
- Code editor (VS Code recommended)
- Git

### Quick Start
```bash
# Clone or init repository
cd celedog

# Create project structure
npm init -y

# Install dependencies
npm install phaser@3.90.0 phaser3-rex-plugins vite -D

# Copy GITHUB_ISSUES.md to GitHub
# Create issues from document

# Start with Issue #1
git checkout -b feature/issue-1-project-setup

# Follow CLAUDE.md for development guidance
```

### Recommended Development Flow
1. Read design document (`celedog_design.md`)
2. Review architecture in `CLAUDE.md`
3. Pick an issue from `GITHUB_ISSUES.md`
4. Create feature branch
5. Implement feature (consult CLAUDE.md for patterns)
6. Write tests
7. Update todo list (mark as completed)
8. Submit PR
9. Merge and move to next issue

---

## Success Metrics

### MVP Launch Goals
- **Technical:** 60 FPS, <3s load, no critical bugs
- **Content:** 10 starter dogs, 50+ pun names
- **Gameplay:** 5-6 week timeline met
- **Quality:** 5+ playtesters approve

### Post-Launch Goals (Optional)
- **Engagement:** 15+ min average session
- **Retention:** 40% D1, 20% D7
- **Virality:** 10% share dogs on social media
- **Progression:** Players reach gen 5+ in first week

---

## Resources

### Key Documents
- `celedog_design.md` - Complete design specification
- `CLAUDE.md` - Development guide for Claude Code
- `GITHUB_ISSUES.md` - Detailed task breakdown (30 issues)
- `README.md` - Project overview

### External Links
- [Phaser 3 Documentation](https://photonstorm.github.io/phaser3-docs/)
- [rexUI Plugin](https://rexrainbow.github.io/phaser3-rex-notes/docs/site/ui-overview/)
- [Phaser Examples](https://phaser.io/examples)
- [RenderTexture Guide](https://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.RenderTexture.html)

---

## Next Steps

**Immediate Actions:**
1. ✅ Create CLAUDE.md (done)
2. ✅ Create GITHUB_ISSUES.md (done)
3. ✅ Create IMPLEMENTATION_PLAN.md (done)
4. ⏭️ Initialize project (Issue #1)
5. ⏭️ Create placeholder assets (Issue #3)
6. ⏭️ Begin Phase 1 implementation

**Ready to code? Start with:**
```bash
git checkout -b feature/issue-1-project-setup
# Follow Issue #1 tasks in GITHUB_ISSUES.md
```

---

*This implementation plan is a living document. Update as the project evolves.*
